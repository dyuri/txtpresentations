<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>VIM + Python</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- metadata -->
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.1" />
<meta name="presdate" content="20090729" />
<meta name="author" content="Gyuri Horak" />
<meta name="company" content="bitnet.hu" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<link rel="stylesheet" href="ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/default/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/default/opera.css" type="text/css" media="projection" id="operaFix" />
<!-- S5 JS -->
<script src="ui/default/slides.js" type="text/javascript"></script>
</head>
<body>

<div class="layout">
<div id="controls"><!-- DO NOT EDIT --></div>
<div id="currentSlide"><!-- DO NOT EDIT --></div>
<div id="header"></div>
<div id="footer">
<h1>budapest.py - 2009. 07. 29.</h1>
<h2>vim + python</h2>
</div>

</div>


<div class="presentation">

<div class="slide">
<h1>VIM + Python</h1>
<h2>VIM, mint ideális Python IDE</h2>
<h3>Horák György (Repa)</h3>
<h4>dyuri kukac horak pont hu</h4>
</div>


<div class="slide">
<h1>Mi az a VIM?</h1>
<table><tr><td>
<ul>
  <li>Vi IMproved</li>
  <li>1991 - Bram Moolenaar</li>
  <li>*nix rendszerekben mindenhol</li>
  <li>... de bárhol máshol is</li>
  <li>... és kb. mindenhez van "vimesítő" plugin</li>
  <li>modális editor (normal, insert, visual, ...)</li>
  <li>~/.vimrc, ~/.vim/</li>
</ul>
</td></tr></table>
<div class="handout">
  Egyébként maga a vi már 1976 óta létezik.
</div>
</div>

<div class="slide">
<h1 class="center">Nem python specifikus dolgok</h1>
</div>

<div class="slide">
<h1>Modelines</h1>
<table><tr><td>
<ul>
  <li>set modelines=5</li>
  <li># vim: fileencoding=utf8:filetype=python:tw=79</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>A vim (ha a modelines változó értéke pozitív szám) megnézi a megnyitott file első és utolsó néhány sorát, hogy talál-e benne neki szóló sort, ami az adott filera vonatkozó konfigurációs beállításokat tartalmaz. Ez a modeline.</p>
  <p>Bár a modlines változó alapesetben 5 szokott lenni, ezt néhany disztribúció megváltoztatja, ezért nem árt, ha mi magunk is beállítjuk a vimrcnkben.</p>
  <p>Python fileok szerkesztésekor külon hasznos a modline használata, ugyanis ha ékezeteket (speciális karaktereket) használunk, kötelező megadnunk az általunk használt kódolást, és a python a vim modeline-t tudja értelmezni ilyen szempontból.</p>
</div>
</div>

<div class="slide">
<h1>FTPlugins</h1>
<table><tr><td>
<ul>
  <li>autocmd FileType python &lt;parancs&gt;</li>
  <li>ftplugin/filetype.vim</li>
  <li>ftplugin/filetype_valami.vim</li>
  <li>ftplugin/filetype/valami.vim</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>File Type Plugins</p>
  <p>Automatikusan betöltődnek az adott filetípusnál (feltéve, hogy nincs kikapcsolva, :filetype plugin on).</p>
</div>
</div>

<div class="slide">
<h1 class="center">VIM, mint Python editor</h1>
</div>

<div class="slide">
<h1>PEP-8</h1>
<table><tr><td>
<pre>
set expandtab
set textwidth=79
set tabstop=8
set softtabstop=4
set shiftwidth=4
</pre>
</td></tr></table>
<div class="handout">
Mehet ftpluginok közé, de akár egy modeline-ba is belefér.
</div>
</div>

<div class="slide">
  <h1>Syntax highlighting, autoindent</h1>
<table><tr><td>
<pre>
syntax on
set autoindent
set number!
set list!
set commentstring=#%s
inoremap # X&lt;C-H&gt;#
</pre>
</td></tr></table>
<div class="handout">
  <p>A syntax hilite-ot, és az automata indentálást nem részletezném miért hasznosak, a number változó allítgatásával a sorszámozást kapcsolhatjuk ki/be, a list változóval pedig a whitespace karaktereket tehetjük "láthatóvá" - ezzel elkerülhetjuk a TAB/space problémákat. (Egyébként a retab parancs lecseréli space-ekre a tabokat, a beallításoknak megfelelő módon.)</p>
  <p>Alapértelmezésben az egész soros commenteket valamiért kicsúsztatja a vim a sor elejére, és akkor oda az aktuális indentálás, ezt kerülhetjük el az utolsó paranccsal.</p>
</div>
</div>

<div class="slide">
<h1 class="center">VIM, mint Python IDE</h1>
</div>

<div class="slide">
<h1>python.vim</h1>
<table><tr><td>
<ul>
  <li>http://www.vim.org/scripts/script.php?script_id=30</li>
  <li>]t, ]e - block elejére/végére ugrás</li>
  <li>]#, ]u - kijelölt szakasz ki/visszacommentelése</li>
  <li>]v - block kijelölése</li>
</ul>
</td></tr></table>
</div>

<div class="slide">
<h1>Folding</h1>
<table><tr><td>
<ul>
  <li>Automatikus: http://www.vim.org/scripts/script.php?script_id=1494</li>
  <li>Manuális:</li>
  <ul>
    <li>set foldmethod=marker</li>
    <li>set commentstring=#%s</li>
    <li>zf, zo, zc</li>
  </ul>
</ul>
</td></tr></table>
<div class="handout">
  <p>A script egyébként Nógrádi Dániel munkaja, aki neve alapján valszeg honfitársunk, köszi.</p>
</div>
</div>

<div class="slide">
<h1>Kódkiegészítés</h1>
<table><tr><td>
<ul>
  <li>^X^O</li>
  <li>autocmd FileType python set omnifunc=pythoncomplete#Complete</li>
  <li>set completeopt=menu,preview</li>
</ul>
</td></tr></table>
<div class="handout">
</div>
</div>

<div class="slide">
<h1>Kódkiegészítés 2.</h1>
<table><tr><td>
<ul>
  <li>$ pysmell . -o PYSMELLTAGS[.valami]</li>
  <li>source pysmell.vim</li>
  <li>set omnifunc=pysmell#Complete</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>A pysmell-nek rajta kell lennie a pythonpath-on természetesen.</p>
  <p>Legegyszerűbb ftpluginnel megoldani a dolgot.</p>
  <p>A PYSMELLTAGS fileoknak a project rootban kell lenniük, hogy a pysmell megtalálja őket, illetve mindenképpen kell egy kiterjesztés nélküli is.</p>
</div>
</div>

<div class="slide">
<h1>Kódkiegészítés screenshot</h1>
<img src="vim_complete.png"/>
</div>

<div class="slide">
<h1>Taglist</h1>
<table><tr><td>
<ul>
  <li>http://www.vim.org/scripts/script.php?script_id=273</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>exuberant ctags kell neki</p>
</div>
</div>

<div class="slide">
<h1>Taglist screenshot</h1>
<img src="vim_taglist.png"/>
</div>

<div class="slide">
<h1>Syntax checking</h1>
<table><tr><td>
<pre style="font-size: 0.5em">
set makeprg=python\ -c\ \"import\ py_compile,sys;\ sys.stderr=sys.stdout;\ py_compile.compile(r'%')\"
set efm=%C\ %.%#,%A\ \ File\ \"%f\"\\,\ line\ %l%.%#,%Z%[%^\ ]%\\@=%m
</pre>
<ul>
  <li>:make</li>
  <li>cn/cp</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>Sajna csak kézzel megy, nem automatikusan a háttérben, de a semminél jobb. A cp/cn parancsokkal ugorhatunk az előző/következő hibára, de a python úgyis megáll az elsőnél :)</p>
</div>
</div>

<div class="slide">
<h1>Kód futtatása</h1>
<table><tr><td>
<ul>
  <li>map &lt;buffer&gt; &lt;S-e&gt; :w&lt;CR&gt;:!/usr/bin/env python %&lt;CR&gt;</li>
</ul>
</td></tr></table>
<div class="handout">
  <p>SHIFT-e megnyomásakor lefuttatja az éppen szerkesztett kódot.</p>
</div>
</div>

<div class="slide">
<h1>Debug</h1>
<table><tr><td>
<ul>
  <li>http://code.google.com/p/vimpdb/</li>
</ul>
</td></tr></table>
</div>


<div class="slide">
<h1>VIM, kiegészítők pythonban</h1>
<table><tr><td>
<ul>
  <li>+python opcióval fordítva (vim --version)</li>
  <li>import vim ...</li>
</ul>
</td></tr></table>
</div>

<div class="slide">
<h1>Kódrészlet futtatása</h1>
<table><tr><td>
<pre style="font-size: 0.7em;">
python &lt;&lt; EOL 
import vim
def EvaluateCurrentRange():
  eval(compile("\n".join(vim.current.range),'','exec'), globals())
EOL
map &lt;F6&gt; :py EvaluateCurrentRange()&lt;CR&gt;
</pre>
</td></tr></table>
</div>

<div class="slide">
  <h1>Sajat debug</h1>
<table><tr><td>
<pre style="font-size: 0.6em;">
def SetBreakpoint():
    import re
    nLine = int( vim.eval( 'line(".")'))

    strLine = vim.current.line
    strWhite = re.search( '^(\s*)', strLine).group(1)

    vim.current.buffer.append(
       "%(space)sfrom ipdb import set_trace;set_trace() %(mark)s Breakpoint %(mark)s" %
         {'space':strWhite, 'mark': '#' * 30}, nLine - 1)

vim.command( 'map &lt;f7&gt; :py SetBreakpoint()&lt;cr&gt;')
</pre>
</td></tr></table>
  <div class="handout">
  Innen van: http://www.cmdln.org/wp-content/uploads/2008/10/python_ipdb.vim
  </div>
</div>

<div class="slide">
  <h1>Sajat debug 2.</h1>
<table><tr><td>
<pre style="font-size: 0.6em;">
def RemoveBreakpoints():
    import re

    nCurrentLine = int( vim.eval( 'line(".")'))

    nLines = []
    nLine = 1
    for strLine in vim.current.buffer:
        if strLine.lstrip()[:38] == 'from ipdb import set_trace;set_trace()':
            nLines.append( nLine)
            print nLine
        nLine += 1

    nLines.reverse()

    for nLine in nLines:
        vim.command( 'normal %dG' % nLine)
        vim.command( 'normal dd')
        if nLine &lt; nCurrentLine:
            nCurrentLine -= 1

    vim.command( 'normal %dG' % nCurrentLine)

vim.command( 'map &lt;s-f7&gt; :py RemoveBreakpoints()&lt;cr&gt;')
</pre>
</td></tr></table>
  <div class="handout">
  Innen van: http://www.cmdln.org/wp-content/uploads/2008/10/python_ipdb.vim
  </div>
</div>

<div class="slide">
<h1>További hasznos kiegészítők</h1>
<table><tr><td>
<ul style="font-size: 0.7em;">
  <li>screen irányítása - http://technotales.wordpress.com/2007/10/03/like-slime-for-vim/</li>
  <li>tasklist - http://www.vim.org/scripts/script.php?script_id=2607</li>
  <li>VCSCommand - http://www.vim.org/scripts/script.php?script_id=90</li>
  <li>NERDTree - http://www.vim.org/scripts/script.php?script_id=1658</li>
  <li>minibuf exporer - http://www.vim.org/scripts/script.php?script_id=159</li>
  <li>snippetsEmu - http://www.vim.org/scripts/script.php?script_id=1318</li>
  <li>http://www.vim.org/scripts/ ...</li>
</ul>
</td></tr></table>
</div>

<div class="slide">
<h1 class="center">Kérdések</h1>
</div>

<div class="slide">
  <h1 class="center">Köszönöm a figyelmet!</h1>
</div>

</div>

</body>
</html>
